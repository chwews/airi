# Репозиторий содержит реализацию тестового задания на стажировку Research Engineer в AIRI в команду "Adaptive agents"

## Структура

utils - Директория содержит python скрипты, реализующие Algorithm Distillation<br />
utils/__ init __.py - инит файл<br />
utils/acrl.py - файл реализации классов Actor-Critic<br />
utils/env.py - файл реализации среды DarkRoom<br />
utils/gpt.py - файл реализации sequence модели GPT<br />
utils/task.py - файл реализации струтуры управления задачами(базовыми алгоритмами)<br />
notebooks - Директория содержит ноутбуки, которые были использованы при реализации<br />
notebooks/kaggle.ipynb - ноутбук, который использовался для проведения экспериментов на kaggle<br />
ad_main.py - основной файл для запуска обучения<br />
alogrithm_distillation.py -  файл содержит функции необходимые для обучения и инференса алгоритма<br />
README.md - информационный файл<br />
requirements.txt - список необходимых для запуска модулей<br />

Структура ноутбучной и скриптовых версий может отличаться в части инференса и параметров обучения так как эксперимены проводились в ноутбуке на платформе kaggle

## Отчеты

Первая часть - Research https://married-pancake-01b.notion.site/Algorithm-Distillation-Research-5147ef1c248a4140bacd80d19a8d6c75?pvs=4

Вторая часть - Engineer https://married-pancake-01b.notion.site/Engineer-b80a4d9a63c84447a63d05a5a44ba026?pvs=4

## Инструкция по запуску

### Notebook

Ноутбуки запускаются ячейка за ячейкой<br />
В секциях Train и Evaluation могут быть измены параметры обучения базовых алгоритмов, GPT и параметры инференса

### Python

Для запуска используется файл ad_main.py<br />
Параметры могут изменены внутри файла для конкретных этапов программы

### Параметры

random_state - сид для рандома
config (GPTConfig) - параметры для sequence модели GPT

create_data_pool (параметры создания пула базовых алгоритмов):
- num_tasks - количество базовых алгоритмов для обучения
- num_episodes - количество эпизодов в одном обучении
- max_episode_len - максимальная длина эпизода
- gamma - гамма обучения

train_model (параметры обучения gpt):
- steps - количество шагов обучения
- history_sample_len - размер сэмпла истории

evaluate_ad (параметры инференса):
- max_steps - максимальное количество шагов для достижения целевой локации
- log - выводить логи изменения среды
- goal_from_tasks - выбрать целевую локацию из целевых локаций базовых алгоритмов или нет

Ноутбук в инференсе содержит дополнительные параметры для проведения экспериментов:
- num_experiments - количество экспериментов
- num_runs - количество запусков в одном эксперименте
- range(start, end, step) - диапозон значений для выбора максимального числа шагов (start - начало, end - конец не включительно, step - размер шага)
